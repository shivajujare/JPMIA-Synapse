{
	"name": "3_Load_Ded_pool_tables",
	"properties": {
		"content": {
			"query": "create MASTER KEY ENCRYPTION BY PASSWORD = 'jpmia#2188';\n\ncreate DATABASE SCOPED CREDENTIAL synapse_sas_exp WITH IDENTITY = 'SHARED ACCESS SIGNATURE',\nSECRET = 'sv=2022-11-02&ss=b&srt=sco&sp=rwdlacyx&se=2024-04-05T03:07:27Z&st=2024-03-21T19:07:27Z&spr=https&sig=%2Bx9j0JqIwONzh0tUqpNhLLy0enka7RB%2F3SA%2BtRTCnjc%3D';\n\nCREATE EXTERNAL DATA SOURCE synapse_exported_data\nWITH (\n    LOCATION = 'https://adlsjpmia.blob.core.windows.net/jpmia-synapse/synapse/workspaces/jpmia-synapse-analytics/exported_data_serverless',\n    CREDENTIAL = synapse_sas_exp\n);\n\nCREATE EXTERNAL FILE FORMAT uv_delta_format\nWITH (\n    FORMAT_TYPE = PARQUET,\n    DATA_COMPRESSION = 'org.apache.hadoop.io.compress.SnappyCodec' -- Optional: specify compression codec\n);\n\ncreate SCHEMA jpmia_ext;\n\n-- Step 3: Create external table in Dedicated SQL pool\nCREATE EXTERNAL TABLE jpmia_ext.exportedCompanyDetail\n(\n    company_id BIGINT,\n    name NVARCHAR(200),\n    description NVARCHAR(3000),\n    company_size int,\n    formatted_company_size NVARCHAR(100),\n    state NVARCHAR(100),\n    country NVARCHAR(100),\n    city NVARCHAR(1000),\n    zip_code NVARCHAR(100),\n    address NVARCHAR(3000),\n    url NVARCHAR(1000),\n    industries NVARCHAR(3000),\n    specialities NVARCHAR(3000),\n    number_of_employees BIGINT,\n    number_of_followers BIGINT\n)\nWITH\n(\n    LOCATION = 'exportedCompanyDetail',\n    DATA_SOURCE = synapse_exported_data,\n    FILE_FORMAT = uv_delta_format\n);\n\n-- Step 4: Insert data into target table\nINSERT INTO jpmia.CompanyDetail\nSELECT *\nFROM jpmia_ext.exportedCompanyDetail;\n\nselect * from jpmia.CompanyDetail;\n--------------------------------------\nCREATE EXTERNAL TABLE jpmia_ext.exportedJobApplicationRate(\n    work_type NVARCHAR(100),\n    application_type NVARCHAR(200),\n    posting_domain NVARCHAR(1000),\n    no_of_applications BIGINT,\n    no_of_views BIGINT,\n    application_percentage DECIMAL(18,2)\n)\nWITH\n(\n    LOCATION = 'exportedJobApplicationRate',\n    DATA_SOURCE = synapse_exported_data,\n    FILE_FORMAT = uv_delta_format\n);\n\n-- Step 4: Insert data into target table\nINSERT INTO jpmia.JobApplicationRate\nSELECT *\nFROM jpmia_ext.exportedJobApplicationRate;\n\nselect * from jpmia.JobApplicationRate;",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "jpmia_reporting",
				"poolName": "jpmia_reporting"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}